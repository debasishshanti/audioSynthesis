<!DOCTYPE html>
<html>
<head>
	<title>autid test</title>
</head>
<body>
	frequency component: <input type="number" id="freq" value="440"></input>
	<br/>
	<br/>
	gain component: <input type="number" id="gain" value="10" step="10"></input>
	<br/>
	<br/>
	<button onclick="start()">Start</button>
	<button onclick="stop()">Stop</button>
	<script type="text/javascript">
		var audio = new window.webkitAudioContext(),
	        position = 0,
	        scale = {
	            g: 392,
	            f: 349.23,
	            e: 329.63,
	            b: 493.88
	        },
	        song = "gfefgg-fff-gbb-gfefggggffgfe---";
	        var timer;
		function start() {
			timer = setInterval(play, 1000 / 4);
		}

		function createOscillator(freq) {
	        var attack = 10,
	            decay = 250,
	            gain = audio.createGain(),
	            gain2 = audio.createGain(),
	            osc = audio.createOscillator(),
	            osc2 = audio.createOscillator();

	        gain.connect(audio.destination);
	        gain.gain.setValueAtTime(0, audio.currentTime);
	        gain.gain.linearRampToValueAtTime(1, audio.currentTime + attack / 1000);
	        gain.gain.linearRampToValueAtTime(0, audio.currentTime + decay / 1000);


	        osc.frequency.value = freq;
	        osc.type = "square";
	        osc.connect(gain);
	        osc.start(0);

	        gain2.gain.value = document.getElementById('gain').value;
	        gain2.connect(osc.frequency);

	        osc2.frequency.value = document.getElementById('freq').value;;
	        osc2.connect(gain2);
		    osc2.start(0);

	        setTimeout(function() {
	            osc2.stop(0);
	            osc2.disconnect(gain2);
	            gain2.disconnect(osc.frequency);
	            osc.stop(0);
	            osc.disconnect(gain);
	            gain.disconnect(audio.destination);
	        }, decay)
	    }

		function play() {
	        var note = song.charAt(position),
	            freq = scale[note];
	        position += 1;
	        if(position >= song.length) {
	            position = 0;
	        }
	        if(freq) {
	            createOscillator(freq);
	        }
	    }
		function stop() {
			clearInterval(timer);
			position = 0;
		}
	</script>
</body>
</html>